{
  "groups": [
    {
      "id": "tables",
      "name": "Tables",
      "icon": "table",
      "itemsSource": {
        "type": "sql",
        "value": "SELECT schemaname AS schema, tablename AS name FROM pg_tables WHERE schemaname = 'public' ORDER BY tablename"
      },
      "itemTemplate": {
        "id": ":schema.:name",
        "icon": "table",
        "name": ":name",
        "visible": true,
        "autoRun": true,
        "queries": [
          {
            "source": {
              "type": "sql",
              "value": "SELECT * FROM \":schema\".\":name\" LIMIT 100"
            },
            "results": "table"
          }
        ]
      }
    },
    {
      "id": "admin",
      "name": "Admin",
      "icon": "settings",
      "items": [
        {
          "id": "cron",
          "name": "Cron",
          "icon": "clock",
          "visible": true,
          "autoRun": true,
          "queries": [
            {
              "source": {
                "type": "sql",
                "value": "SELECT jobid, jobname, schedule, command, active FROM cron.job ORDER BY jobname"
              },
              "results": "table",
              "rowActions": [
                {
                  "label": "Edit",
                  "itemId": "edit",
                  "params": { "jobid": "jobid" }
                },
                {
                  "label": "Delete",
                  "itemId": "delete",
                  "params": { "jobid": "jobid" },
                  "variant": "destructive"
                }
              ]
            }
          ],
          "primaryAction": {
            "label": "Create Job",
            "itemId": "create"
          },
          "children": [
            {
              "id": "create",
              "name": "Create Job",
              "visible": false,
              "queries": [
                {
                  "source": {
                    "type": "sql",
                    "value": "SELECT cron.schedule(':jobname', ':schedule', ':command')"
                  },
                  "returnToParent": true,
                  "results": null,
                  "parameters": [
                    {
                      "name": "jobname",
                      "label": "Job Name",
                      "type": "text",
                      "required": true,
                      "placeholder": "my-cron-job"
                    },
                    {
                      "name": "schedule",
                      "label": "Schedule",
                      "type": "text",
                      "required": true,
                      "placeholder": "*/5 * * * *"
                    },
                    {
                      "name": "command",
                      "label": "Command",
                      "type": "textarea",
                      "required": true,
                      "placeholder": "SELECT my_function()"
                    }
                  ]
                }
              ]
            },
            {
              "id": "edit",
              "name": "Edit Job",
              "visible": false,
              "queries": [
                {
                  "source": {
                    "type": "sql",
                    "value": "UPDATE cron.job SET jobname = :jobname, schedule = :schedule, command = :command, active = :active WHERE jobid = :jobid"
                  },
                  "loader": {
                    "type": "sql",
                    "value": "SELECT * FROM cron.job WHERE jobid = :jobid"
                  },
                  "returnToParent": true,
                  "results": null,
                  "parameters": [
                    {
                      "name": "jobname",
                      "label": "Job Name",
                      "type": "text",
                      "required": true
                    },
                    {
                      "name": "schedule",
                      "label": "Schedule",
                      "type": "text",
                      "required": true
                    },
                    {
                      "name": "command",
                      "label": "Command",
                      "type": "textarea",
                      "required": true
                    },
                    { "name": "active", "label": "Active", "type": "boolean" }
                  ]
                }
              ]
            },
            {
              "id": "delete",
              "name": "Delete Job",
              "visible": false,
              "queries": [
                {
                  "source": {
                    "type": "sql",
                    "value": "SELECT cron.unschedule(:jobid)"
                  },
                  "loader": {
                    "type": "sql",
                    "value": "SELECT * FROM cron.job WHERE jobid = :jobid"
                  },
                  "returnToParent": true,
                  "results": null,
                  "parameters": [
                    {
                      "name": "jobid",
                      "label": "Job ID",
                      "type": "text",
                      "required": true
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "id": "users",
          "name": "Users",
          "icon": "contact",
          "visible": true,
          "autoRun": true,
          "queries": [
            {
              "source": {
                "type": "sql",
                "value": "SELECT d.date::date as date, count(u.id) as count FROM generate_series(date_trunc('week', current_date - interval '3 months'), date_trunc('week', current_date), '1 week'::interval) as d(date) LEFT JOIN auth.users u ON date_trunc('week', u.created_at)::date = d.date::date GROUP BY 1 ORDER BY 1"
              },
              "results": "chart",
              "chart": {
                "xAxis": {
                  "name": "date",
                  "label": "Date"
                },
                "yAxis": [
                  {
                    "name": "count",
                    "label": "Users"
                  }
                ]
              }
            },
            {
              "source": {
                "type": "sql",
                "value": "SELECT id, email, created_at, last_sign_in_at FROM auth.users ORDER BY created_at DESC LIMIT 50"
              },
              "results": "table"
            }
          ]
        },
        {
          "id": "resend",
          "name": "Resend Contacts",
          "icon": "mail",
          "visible": true,
          "autoRun": true,
          "queries": [
            {
              "source": {
                "type": "edge_function",
                "name": "resend/contacts",
                "value": "{\n  \"method\": \"GET\"\n}"
              },
              "results": "table",
              "rowActions": [
                {
                  "label": "Edit",
                  "itemId": "edit-contact",
                  "params": { "id": "id" }
                },
                {
                  "label": "Delete",
                  "itemId": "delete-contact",
                  "params": { "id": "id" },
                  "variant": "destructive"
                }
              ]
            }
          ],
          "primaryAction": {
            "label": "Add Contact",
            "itemId": "create-contact"
          },
          "children": [
            {
              "id": "create-contact",
              "name": "Add Contact",
              "visible": false,
              "queries": [
                {
                  "source": {
                    "type": "edge_function",
                    "name": "resend/contacts",
                    "value": "{\n  \"method\": \"POST\",\n  \"body\": {\n    \"email\": \":email\",\n    \"first_name\": \":first_name\",\n    \"last_name\": \":last_name\"\n  }\n}"
                  },
                  "returnToParent": true,
                  "results": null,
                  "parameters": [
                    {
                      "name": "email",
                      "label": "Email",
                      "type": "text",
                      "required": true
                    },
                    {
                      "name": "first_name",
                      "label": "First Name",
                      "type": "text",
                      "required": true
                    },
                    {
                      "name": "last_name",
                      "label": "Last Name",
                      "type": "text",
                      "required": true
                    }
                  ]
                }
              ]
            },
            {
              "id": "edit-contact",
              "name": "Edit Contact",
              "visible": false,
              "autoRun": true,
              "queries": [
                {
                  "source": {
                    "type": "edge_function",
                    "name": "resend/contacts/:id",
                    "value": "{\n  \"method\": \"PATCH\",\n  \"body\": {\n    \"firstName\": \":first_name\",\n    \"lastName\": \":last_name\",\n    \"unsubscribed\": :unsubscribed\n  }\n}"
                  },
                  "loader": {
                    "type": "edge_function",
                    "name": "resend/contacts/:id",
                    "value": "{\n  \"method\": \"GET\"\n}"
                  },
                  "returnToParent": true,
                  "results": null,
                  "parameters": [
                    {
                      "name": "first_name",
                      "label": "First Name",
                      "type": "text",
                      "required": true
                    },
                    {
                      "name": "last_name",
                      "label": "Last Name",
                      "type": "text",
                      "required": true
                    },
                    {
                      "name": "unsubscribed",
                      "label": "Unsubscribed",
                      "type": "boolean",
                      "required": true
                    }
                  ]
                }
              ]
            },
            {
              "id": "delete-contact",
              "name": "Delete Contact",
              "visible": false,
              "queries": [
                {
                  "source": {
                    "type": "edge_function",
                    "name": "resend/contacts/:id",
                    "value": "{\n  \"method\": \"DELETE\"\n}"
                  },
                  "loader": {
                    "type": "edge_function",
                    "name": "resend/contacts/:id",
                    "value": "{\n  \"method\": \"GET\"\n}"
                  },
                  "returnToParent": true,
                  "results": null,
                  "parameters": [
                    {
                      "name": "id",
                      "label": "Contact ID",
                      "type": "text",
                      "required": true,
                      "hidden": true
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "id": "resend-templates",
          "name": "Resend Templates",
          "icon": "layout-template",
          "visible": true,
          "autoRun": true,
          "queries": [
            {
              "source": {
                "type": "edge_function",
                "name": "resend/templates",
                "value": "{\n  \"method\": \"GET\"\n}"
              },
              "results": "table"
            }
          ]
        }
      ]
    },
    {
      "id": "scripts",
      "name": "Scripts",
      "icon": "file-text",
      "itemsFromState": "tabs",
      "userCreatable": true,
      "itemTemplate": {
        "id": ":id",
        "name": "Untitled",
        "icon": "file-text",
        "visible": true,
        "queries": [
          {
            "source": {
              "type": "sql",
              "value": ""
            },
            "results": "table"
          }
        ]
      }
    }
  ]
}
